---
title: "p8105_hw2_ml5018"
author: "Luan Mengxiao"
date: 2023-09-26
output: github_document
---

This is a R Markdown document for homework 2.

Load the package to be used for data processing.

```{r setup, message = FALSE}
library(tidyverse)
```

# Problem 1

## pols_month

First, clean the data in pols-month.csv. Use `separate()` to break up the variable mon into integer variables `year`, `month`, and `day`; replace month number with month name; create a `president` variable taking values `gop` and `dem`, and remove `prez_dem` and `prez_gop`; and remove the `day` variable.

```{r pols_month}
pols_month_df = 
  read_csv("fivethirtyeight_datasets/pols-month.csv") |>
  janitor::clean_names() |>
  separate(mon, into = c("year", "month", "day"), sep = "-") |>
  mutate(month = month.name[as.numeric(month)]) |>
  mutate(president = prez_gop - prez_dem,
         president = case_match(president, 1  ~ "gop", -1 ~ "dem")) |>
  select(-prez_dem, -prez_gop,-day)
```

## snp

Second, clean the data in snp.csv using a similar process to the above. For consistency across datasets, arrange according to year and month, and organize so that `year` and `month` are the leading columns.

```{r snp}
snp_df = 
  read_csv("fivethirtyeight_datasets/snp.csv") |>
  janitor::clean_names() |>
  separate(date, into = c("month", "day", "year"), sep = "/") |>
  mutate(month = month.name[as.numeric(month)],
         year = as.numeric(year),
         year = as.character(case_when(year >= 23 ~ year + 1900,
                          year <  23 ~ year + 2000))) |>
  arrange(year, month)
```

## unemployment

Third, tidy the unemployment data so that it can be merged with the previous datasets. This process will involve switching from “wide” to “long” format; ensuring that key variables have the same name; and ensuring that key variables take the same values.

```{r unemployment}
unemployment_df = 
  read_csv("fivethirtyeight_datasets/unemployment.csv") |>
  janitor::clean_names() |>
  pivot_longer(jan:dec, 
               names_to = "month", 
               values_to = "percentage_of_unemployment") |>
  mutate(year = as.character(year),
         month = recode(month,
                        jan = "January",
                        feb = "February",
                        mar = "March",
                        apr = "April",
                        may = "May",
                        jun = "June",
                        jul = "July",
                        aug = "August",
                        sep = "September",
                        oct = "October",
                        nov = "November",
                        dec = "December"
                        )
         )
```

## join datasets

Join the datasets by merging `snp` into `pols`, and merging `unemployment` into the result.

```{r join}
problem1_df = 
  left_join(pols_month_df, snp_df) |>
  left_join(unemployment_df)
```

## describe datasets

Write a short paragraph about these datasets. Explain briefly what each dataset contained, and describe the resulting dataset (e.g. give the dimension, range of years, and names of key variables).

The main data contained in the three datasets are listed as follow:

The file “pols-month” contains 822 observations of 9 variables related to the number of national politicians who are democratic or republican at any given time:

* mon: date of the count
* prez_gop: indicator of whether the president was republican on the associated date (1 = yes, 0 = no)
* gov_gop: the number of republican governors on the associated date
* sen_gop: the number of republican senators on the associated date
* rep_gop: the number of republican representatives on the associated date
* prez_dem: indicator of whether the president was democratic on the associated date (1 = yes, 0 = no)
* gov_dem: the number of democratic governors on the associated date
* sen_dem: the number of democratic senators on the associated date
* rep_dem: the number of democratic representatives on the associated date

The file “snp” contains 787 observations of 2 variables related to Standard & Poor’s stock market index (S&P), often used as a representative measure of stock market as a whole:

* date: the date of the observation
* close: the closing values of the S&P stock index on the associated date

The file “unemployment” contains 68 observations of 13 variables:

* Year: the year of the measurements on that row
* Jan: percentage of unemployment in January of the associated year
* Feb: percentage of unemployment in February of the associated year
* Mar: percentage of unemployment in March of the associated year
* Apr: percentage of unemployment in April of the associated year
* May: percentage of unemployment in May of the associated year
* Jun: percentage of unemployment in June of the associated year
* Jul: percentage of unemployment in July of the associated year
* Aug: percentage of unemployment in August of the associated year
* Sep: percentage of unemployment in September of the associated year
* Oct: percentage of unemployment in October of the associated year
* Nov: percentage of unemployment in November of the associated year
* Dec: percentage of unemployment in December of the associated year

Using the code chunk below to further describe the resulting dataset:

```{r describe}
skimr::skim(problem1_df)
```

The merged dataset contains `r dim(problem1_df)[1]` observations of `r dim(problem1_df)[2]` variables.

The variable `year` included in this dataset ranges from `r range(problem1_df$year)[1]` to `r range(problem1_df$year)[2]`.

The names of some key variables in the dataset include: `r names(problem1_df)`.